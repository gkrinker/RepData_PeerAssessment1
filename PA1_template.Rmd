---
title: "Reproducible Research: Peer Assessment 1"
author: "Georges Krinker"
output: 
  html_document:
    keep_md: true
---

This document describes the loading, pre-processing and analysis of data from a personal activity monitoring device. The data consists of two months of data from an anonymous individual collected during the months of October and November, 2012 and include the number of steps taken in 5 minute intervals each day.

In this document we will perform the following analysis - 

1. Generate a Histogram of the total number of steps taken each day
2. Determine the mean and median total number of steps taken per day
3. Draw a time series plot of the average number of steps taken.
4. Determine the 5-minute interval that, on average, contains the maximum number of steps
5. Inpute missing data (represented in the data with NAs)
6. Generate a Histogram of the total number of steps taken each day after missing values are imputed.
7. Create a Panel plot comparing the average number of steps taken per 5-minute interval across weekdays and weekends. 


## Loading and preprocessing the data

We are first going to load the data as a data frame.

```{r loading data}
data <- read.csv("activity.csv")
```

In order to make our analysis easier, we are going to convert the date variable into a factor.

```{r make date factor}
data$date <- as.factor(data$date)
```

## What is mean total number of steps taken per day?

Our first step in the analysis is to produce a histogram of the total number of steps across each day.

```{r histogram}
stepsPerday <- aggregate(data$steps, by = list(Date = data$date), FUN = sum, na.rm = TRUE)

names(stepsPerday)[2] <- "TotalSteps"

hist(stepsPerday$TotalSteps, main = "Histogram of Total Number of Steps per day", xlab = "Number of Steps per Day", ylab = "Frequency", ylim = c(0,35))
```

Now, we calculate the mean and median steps taken per day.

```{r mean steps per day}

mean(stepsPerday$TotalSteps)

```

```{r median steps per day}

median(stepsPerday$TotalSteps)

```

## What is the average daily activity pattern?

We first aggregate for the average (interpreted as mean) over the 5 minute intervals across days.

```{r mean over intervals }

AverageStepsByInterval = aggregate(data$steps, by = list(data$interval), FUN = mean, na.rm = TRUE)

```

Now we plot a time series (type = 'l') of the average number of steps of each interval across days.

```{r time series over 5 minutes intervals}

plot(AverageStepsByInterval[[1]], AverageStepsByInterval[[2]], type="l", ylab = "Average Number of Steps", xlab = "Interval", main = "Average Number of Steps for each Interval across days")

```

And finally we look for the 5 minute interval that has the maxmimum average number of steps across days. In order to do that, we sort the dataframe containing the Average steps of intervals across days and return the interval in the first row.

```{r max average of interval across days}

##Sort by highest average across days
AverageStepsByInterval <- AverageStepsByInterval[order(AverageStepsByInterval[[2]]),]

##return interval in first row of sorted data frame
AverageStepsByInterval[1,1]

```

The interval with maximum average number of steps across days is interval `r AverageStepsByInterval[1,1]`.

## Imputing missing values

There is a total of `r sum(apply(data, 1, function(x) sum(is.na(x))))` NAs in the dataset.

## Are there differences in activity patterns between weekdays and weekends?
